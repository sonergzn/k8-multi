apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
  - ../../../k8_files #Pointing to our manifests. 
                      #(kustomization.yaml should be present in this directory. (generated with 'kustomoze build'))
namespace: default
replicas:
  - name: client-deployment #Name of our deployment (look at client-deployment.yaml file)
    count: 3 #This count variable overrides the 'replicas' parameter in your deployment. (this value always comes first)
  - name: worker-deployment
    count: 1
  - name: server-deployment
    count: 3
images:
  - name: sonergezgen/multi-client:$(TAG)
    newTag: "$(TAG)" #This value will be replaced with the circliCI buildID
  - name: sonergezgen/multi-worker:$(TAG)
    newTag: "$(TAG)"
  - name: sonergezgen/multi-server:$(TAG)
    newTag: "$(TAG)"

